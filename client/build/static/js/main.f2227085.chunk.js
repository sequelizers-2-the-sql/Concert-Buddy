(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{20:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),l=n.n(o),c=(n(46),n(3)),s=n.n(c),i=n(9),u={concertArtist:function(e){return s.a.get("https://api.songkick.com/api/3.0/search/artists.json?apikey=5lteuiQE9y5NzSiJ&query="+e).then(function(e){var t=+e.data.resultsPage.results.artist[0].id;return console.log(t),s.a.get("https://api.songkick.com/api/3.0/artists/".concat(t,"/calendar.json?apikey=5lteuiQE9y5NzSiJ"))})},concertZip:function(e){return s.a.get("https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key=AIzaSyAZuF8mTrMiYKcZ7z_Z8HnPrG201L2kpqY").then(function(e){var t=+e.data.results[0].geometry.location.lat,n=+e.data.results[0].geometry.location.lng;return s.a.get("https://api.songkick.com/api/3.0/search/locations.json?location=geo:".concat(t,",").concat(n,"&apikey=5lteuiQE9y5NzSiJ"))}).then(function(e){var t=+e.data.resultsPage.results.location[0].metroArea.id;return s.a.get("https://api.songkick.com/api/3.0/metro_areas/".concat(t,"/calendar.json?apikey=5lteuiQE9y5NzSiJ"))})}},m={attendConcert:function(e){return s.a.post("/api/concerts",e)},getConcert:function(e){return s.a.get("/api/concerts/"+e)}};function p(e){return r.a.createElement("div",{className:"form-group"},r.a.createElement("input",Object.assign({className:"form-control"},e)))}function f(e){return r.a.createElement("button",Object.assign({},e,{style:{float:"right",marginBottom:9},className:"btn btn-success"}),e.children)}n(26);function h(e){return r.a.createElement("div",{className:"container"},r.a.createElement("hgroup",{className:"mb20"},r.a.createElement("h1",null,"Concerts Below"),r.a.createElement("h2",{className:"lead"},r.a.createElement("strong",{className:"text-danger"},e.number)," results were found for the search for ",r.a.createElement("strong",{className:"text-danger"},e.input))))}function d(e){return r.a.createElement("div",null,r.a.createElement("section",{className:"listItem col-xs-12 col-sm-6 col-md-12"},r.a.createElement("article",{className:"search-result row"},r.a.createElement("div",{className:"col-xs-12 col-sm-12 col-md-7 excerpet"},r.a.createElement("h3",{className:"result-title",onClick:function(){e.clickHandler(e.event)}},e.event.displayName),r.a.createElement("p",null,e.event.displayName)),r.a.createElement("span",{className:"clearfix borda"}))),r.a.createElement("hr",null))}var y=function(e){return r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"Zip",checked:e.zip,onChange:e.change}),"Zip")),r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"Artist",checked:e.artist,onChange:e.change}),"Artist")))};function g(e){e.props;var t=e.children;return r.a.createElement("div",{className:"container"},t)}function v(e){var t=e.children;return r.a.createElement("div",{className:"row"},t)}function b(e){var t=e.size,n=e.children;return r.a.createElement("div",{className:t.split(" ").map(function(e){return"col-"+e}).join(" ")},n)}function E(e){return(E="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function N(e,t){return!t||"object"!==E(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.getPrototypeOf||function(e){return e.__proto__})(e)}var _=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return N(a,(n=a=N(this,(e=k(t)).call.apply(e,[this].concat(o))),a.state={events:[],search:"",selector:"",input:""},a.handleFormSubmit=function(e){e.preventDefault(),a.state.search&&a.state.selector&&("Zip"===a.state.selector?u.concertZip(a.state.search).then(function(e){var t=e.data.resultsPage.results.event;t.length>20&&(t.length=20),console.log(t),a.setState({events:t})}).catch(function(e){return console.log(e)}):"Artist"===a.state.selector&&u.concertArtist(a.state.search).then(function(e){var t=e.data.resultsPage.results.event;t.length>20&&(t.length=20),console.log(t),a.setState({events:t})}))},a.attendEvent=function(e){var t=e;console.log(e),m.attendConcert({artist:t.performance[0].artist.displayName,venue:t.venue.displayName,date:t.start.date,time:t.start.time,city:t.venue.metroArea.displayName,latitude:t.venue.lat,longitude:t.venue.lng}).then(function(e){return window.location.href="/concerts/"+e.data._id}).catch(function(e){return console.log(e)})},a.handleRadioChange=function(e){a.setState({selector:e.target.value})},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,r))},n))}var n,a,o;return n=t,(a=[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,null,r.a.createElement(v,null,r.a.createElement(b,{size:"md-12"},r.a.createElement("form",null,r.a.createElement(p,{value:this.state.search,onChange:this.handleInputChange,name:"search",placeholder:"Search"}),r.a.createElement(y,{zip:"Zip"===this.state.selector,artist:"Artist"===this.state.selector,change:this.handleRadioChange}),r.a.createElement(f,{disabled:!this.state.search,onClick:this.handleFormSubmit},"Search")),r.a.createElement(h,{number:this.state.events.length,input:this.state.search}),this.state.events?this.state.events.map(function(t,n){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{event:t,clickHandler:e.attendEvent,key:n}))}):r.a.createElement("h3",null,"No Results to Display")))))}}])&&S(n.prototype,a),o&&S(n,o),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");w(e.prototype,t&&t.prototype),t&&w(e,t)}(t,e),t}(a.Component);function C(e){return(C="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e,t){return!t||"object"!==C(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.getPrototypeOf||function(e){return e.__proto__})(e)}var T=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return P(a,(n=a=P(this,(e=x(t)).call.apply(e,[this].concat(o))),a.state={event:{}},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,r))},n))}var n,a,o;return n=t,(a=[{key:"componentDidMount",value:function(){var e=this;m.getConcert(this.props.match.params.id).then(function(t){e.setState({event:t.data}),console.log(e.state.event.artist)}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,null,r.a.createElement(v,null,r.a.createElement(b,{size:"md-12"},r.a.createElement("h1",null,this.state.event.artist),r.a.createElement("h2",null,"Playing at ",this.state.event.venue," at ",this.state.event.time)))))}}])&&O(n.prototype,a),o&&O(n,o),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");j(e.prototype,t&&t.prototype),t&&j(e,t)}(t,e),t}(a.Component);function U(e){return(U="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e){return(I=Object.getPrototypeOf||function(e){return e.__proto__})(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Z=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(a=I(t).call(this))||"object"!==U(a)&&"function"!==typeof a?F(n):a).state={username:"",password:"",confirmPassword:""},e.handleSubmit=e.handleSubmit.bind(F(F(e))),e.handleChange=e.handleChange.bind(F(F(e))),e}var n,a,o;return n=t,(a=[{key:"handleChange",value:function(e){var t,n,a;this.setState((t={},n=e.target.name,a=e.target.value,n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t))}},{key:"handleSubmit",value:function(e){var t=this;console.log("sign-up handleSubmit, username: "),console.log(this.state.username),e.preventDefault(),s.a.post("/api/users/signup  ",{username:this.state.username,password:this.state.password}).then(function(e){console.log(e),e.data.errmsg?console.log("username already taken"):(console.log("successful signup"),t.setState({redirectTo:"/login"}))}).catch(function(e){console.log("signup error: "),console.log(e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"SignupForm"},r.a.createElement("h4",null,"Sign up"),r.a.createElement("form",{className:"form-horizontal"},r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"username"},"Username")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",type:"text",id:"username",name:"username",placeholder:"Username",value:this.state.username,onChange:this.handleChange}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"password"},"Password: ")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",placeholder:"password",type:"password",name:"password",value:this.state.password,onChange:this.handleChange}))),r.a.createElement("div",{className:"form-group "},r.a.createElement("div",{className:"col-7"}),r.a.createElement("button",{className:"btn btn-primary col-1 col-mr-auto",onClick:this.handleSubmit,type:"submit"},"Sign up"))))}}])&&A(n.prototype,a),o&&A(n,o),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");z(e.prototype,t&&t.prototype),t&&z(e,t)}(t,e),t}(a.Component),D=n(57);function R(e){return(R="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function B(e){return(B=Object.getPrototypeOf||function(e){return e.__proto__})(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Q=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(a=B(t).call(this))||"object"!==R(a)&&"function"!==typeof a?G(n):a).state={username:"",password:"",redirectTo:null},e.handleSubmit=e.handleSubmit.bind(G(G(e))),e.handleChange=e.handleChange.bind(G(G(e))),e}var n,a,o;return n=t,(a=[{key:"handleChange",value:function(e){var t,n,a;this.setState((t={},n=e.target.name,a=e.target.value,n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("handleSubmit"),s.a.post("/user/login",{username:this.state.username,password:this.state.password}).then(function(e){console.log("login response: "),console.log(e),200===e.status&&(t.props.updateUser({loggedIn:!0,username:e.data.username}),t.setState({redirectTo:"/"}))}).catch(function(e){console.log("login error: "),console.log(e)})}},{key:"render",value:function(){return this.state.redirectTo?r.a.createElement(D.a,{to:{pathname:this.state.redirectTo}}):r.a.createElement("div",null,r.a.createElement("h4",null,"Login"),r.a.createElement("form",{className:"form-horizontal"},r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"username"},"Username")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",type:"text",id:"username",name:"username",placeholder:"Username",value:this.state.username,onChange:this.handleChange}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"col-1 col-ml-auto"},r.a.createElement("label",{className:"form-label",htmlFor:"password"},"Password: ")),r.a.createElement("div",{className:"col-3 col-mr-auto"},r.a.createElement("input",{className:"form-input",placeholder:"password",type:"password",name:"password",value:this.state.password,onChange:this.handleChange}))),r.a.createElement("div",{className:"form-group "},r.a.createElement("div",{className:"col-7"}),r.a.createElement("button",{className:"btn btn-primary col-1 col-mr-auto",onClick:this.handleSubmit,type:"submit"},"Login"))))}}])&&M(n.prototype,a),o&&M(n,o),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");J(e.prototype,t&&t.prototype),t&&J(e,t)}(t,e),t}(a.Component);n(22);function H(e){return r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark"},r.a.createElement("a",{className:"navbar-brand",href:"/"},"ConcertBuddy"),r.a.createElement("ul",{class:"nav nav-pills"},r.a.createElement("li",{class:"nav-item"},r.a.createElement("a",{class:"nav-link logo-nav",href:"/"},"home")),r.a.createElement("li",{class:"nav-item"},r.a.createElement("a",{class:"nav-link logo-nav",href:"/myevents"},"my events")),r.a.createElement("li",{class:"nav-item"},r.a.createElement("a",{class:"nav-link logo-nav",href:"/use/logout"},"logout")))))}n(21);function L(e){return(L="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function K(e){return(K=Object.getPrototypeOf||function(e){return e.__proto__})(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var W=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(a=K(t).call(this))||"object"!==L(a)&&"function"!==typeof a?V(n):a).state={loggedIn:!1,username:null},e.getUser=e.getUser.bind(V(V(e))),e.componentDidMount=e.componentDidMount.bind(V(V(e))),e.updateUser=e.updateUser.bind(V(V(e))),e}var n,a,o;return n=t,(a=[{key:"componentDidMount",value:function(){this.getUser()}},{key:"updateUser",value:function(e){this.setState(e)}},{key:"getUser",value:function(){var e=this;s.a.get("/user/").then(function(t){console.log("Get user response: "),console.log(t.data),t.data.user?(console.log("Get User: There is a user saved in the server session: "),e.setState({loggedIn:!0,username:t.data.user.username})):(console.log("Get user: no user"),e.setState({loggedIn:!1,username:null}))})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(H,{updateUser:this.updateUser,loggedIn:this.state.loggedIn}),this.state.loggedIn&&r.a.createElement("p",null,"You are logged in, ",this.state.username,"!!!!"),r.a.createElement(i.a,{exact:!0,path:"/",component:_}),r.a.createElement(i.a,{path:"/login",render:function(){return r.a.createElement(Q,{updateUser:e.updateUser})}}),r.a.createElement(i.a,{path:"/signup",render:function(){return r.a.createElement(Z,null)}}),r.a.createElement(i.a,{exact:!0,path:"/concerts/:id",component:T}))}}])&&q(n.prototype,a),o&&q(n,o),function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Y(e.prototype,t&&t.prototype),t&&Y(e,t)}(t,e),t}(a.Component),X=n(58);l.a.render(r.a.createElement(X.a,null,r.a.createElement(W,null)),document.getElementById("root"))},21:function(e,t,n){},22:function(e,t,n){},26:function(e,t,n){},46:function(e,t,n){},56:function(e,t,n){n(55),e.exports=n(20)}},[[56,0,1]]]);
//# sourceMappingURL=main.f2227085.chunk.js.map